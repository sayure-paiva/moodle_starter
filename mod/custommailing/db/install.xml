<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" PATH="mod/custommailing/db" VERSION="20210217"
       COMMENT="XMLDB file for Moodle mod_custommailing"
       xsi:noNamespaceSchemaLocation="../../../lib/xmldb/xmldb.xsd"
>
    <TABLES>
        <TABLE NAME="custommailing" COMMENT="Stores the custommailing activity module instances.">
            <FIELDS>
                <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
                <FIELD NAME="course" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="ID of the course this activity is part of."/>
                <FIELD NAME="name" TYPE="char" LENGTH="255" NOTNULL="true" SEQUENCE="false" COMMENT="The name of the activity module instance"/>
                <FIELD NAME="intro" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="Activity description."/>
                <FIELD NAME="introformat" TYPE="int" LENGTH="4" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The format of the intro field."/>
                <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false"/>
                <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false"/>
            </FIELDS>
            <KEYS>
                <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
                <KEY NAME="fk_course" TYPE="foreign" FIELDS="course" REFTABLE="course" REFFIELDS="id"/>
            </KEYS>
        </TABLE>
        <TABLE NAME="custommailing_mailing" COMMENT="Stores the mailing of a particular custommailing activity module instance">
            <FIELDS>
                <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
                <FIELD NAME="custommailingid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="custommailing activity ID"/>
                <FIELD NAME="mailingname" TYPE="char" LENGTH="255" NOTNULL="true" SEQUENCE="false" COMMENT="Mailing name"/>
                <FIELD NAME="mailinglang" TYPE="char" LENGTH="4" NOTNULL="true" DEFAULT="en" SEQUENCE="false" COMMENT="Mailing lang (EN, FR, NL, ...)"/>
                <FIELD NAME="mailingsubject" TYPE="char" LENGTH="255" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The subject of the mailing"/>
                <FIELD NAME="mailingcontent" TYPE="text" LENGTH="4" NOTNULL="true" SEQUENCE="false" COMMENT="The content of the mailing"/>
                <FIELD NAME="mailingcontentformat" TYPE="int" LENGTH="4" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The format of the mailing content field."/>
                <FIELD NAME="mailingmode" TYPE="int" LENGTH="4" NOTNULL="true" DEFAULT="0" SEQUENCE="false" COMMENT="The mode of the mailing (see locallib.php)"/>
                <FIELD NAME="mailingdelay" TYPE="int" LENGTH="4" NOTNULL="false" DEFAULT="7" SEQUENCE="false" COMMENT="The delay of the mailing (days)"/>
                <FIELD NAME="mailingstatus" TYPE="int" LENGTH="4" NOTNULL="true" DEFAULT="1" SEQUENCE="false" COMMENT="The mailing status (enabled / disabled)"/>
                <FIELD NAME="retroactive" TYPE="int" LENGTH="4" NOTNULL="true" DEFAULT="1" SEQUENCE="false" COMMENT="The mailing retroactive mode (enabled / disabled)"/>
                <FIELD NAME="targetmoduleid" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false" COMMENT="The linked module ID (triggering activity)"/>
                <FIELD NAME="targetmodulestatus" TYPE="int" LENGTH="4" NOTNULL="false" DEFAULT="0" SEQUENCE="false" COMMENT="The linked module status (triggering activity)"/>
                <FIELD NAME="customcertmoduleid" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false" COMMENT="The linked module customcert ID (optional)"/>
                <FIELD NAME="starttime" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false" COMMENT="The time when the mailing must start"/>
                <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false"/>
                <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false"/>
            </FIELDS>
            <KEYS>
                <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
                <KEY NAME="fk_custommailingid" TYPE="foreign" FIELDS="custommailingid" REFTABLE="custommailing" REFFIELDS="id"/>
                <KEY NAME="fk_targetmoduleid" TYPE="foreign" FIELDS="targetmoduleid" REFTABLE="course_modules" REFFIELDS="id"/>
                <KEY NAME="fk_customcertmoduleid" TYPE="foreign" FIELDS="customcertmoduleid" REFTABLE="course_modules" REFFIELDS="id"/>
            </KEYS>
            <INDEXES>
                <INDEX NAME="timecreated" UNIQUE="false" FIELDS="timecreated"/>
                <INDEX NAME="mailingname" UNIQUE="false" FIELDS="mailingname"/>
            </INDEXES>
        </TABLE>
        <TABLE NAME="custommailing_logs" COMMENT="Stores logs generated by mailings">
            <FIELDS>
                <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
                <FIELD NAME="custommailingmailingid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="The custommailing_mailing ID"/>
                <FIELD NAME="emailtouserid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="The user ID"/>
                <FIELD NAME="emailstatus" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Status (see locallib.php)"/>
                <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false"/>
                <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false"/>
            </FIELDS>
            <KEYS>
                <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
                <KEY NAME="fk_custommailingmailingid" TYPE="foreign" FIELDS="custommailingmailingid" REFTABLE="custommailing_mailing" REFFIELDS="id"/>
                <KEY NAME="fk_emailtouserid" TYPE="foreign" FIELDS="emailtouserid" REFTABLE="user" REFFIELDS="id"/>
            </KEYS>
            <INDEXES>
                <INDEX NAME="emailstatus" UNIQUE="false" FIELDS="emailstatus"/>
            </INDEXES>
        </TABLE>
    </TABLES>
</XMLDB>
